(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{sF:()=>g,Qg:()=>y});const t=window.React,s=window.wp.element,r=window.wp.components;class o extends s.Component{constructor(){super(...arguments)}render(){let e=(0,t.createElement)("span",{dangerouslySetInnerHTML:{__html:this.props.field.help}}),s="";return this.props.object.state.results[this.props.field_name]&&(this.props.object.state.results[this.props.field_name].result.error?(s="easy-setup-for-wordpress-error",this.props.object.state.results[this.props.field_name].result.text&&(e=(0,t.createElement)(t.Fragment,null,(0,t.createElement)("span",{className:"hint"},this.props.object.state.results[this.props.field_name].result.text),(0,t.createElement)("span",{dangerouslySetInnerHTML:{__html:this.props.field.help}})))):this.props.object.state[this.props.field_name]&&this.props.object.state[this.props.field_name].length>0&&(s="easy-setup-for-wordpress-ok")),(0,t.createElement)(r.RadioControl,{label:this.props.field.label,className:s,help:e,onChange:e=>g(this.props.object,this.props.field_name,this.props.field,e),selected:this.props.object.state[this.props.field_name],options:this.props.field.options})}}class n extends s.Component{constructor(){super(...arguments)}render(){let e=(0,t.createElement)("span",{dangerouslySetInnerHTML:{__html:this.props.field.help}}),s="";return this.props.object.state.results[this.props.field_name]&&(this.props.object.state.results[this.props.field_name].result.error?(s="easy-setup-for-wordpress-error",this.props.object.state.results[this.props.field_name].result.text&&(e=(0,t.createElement)(t.Fragment,null,(0,t.createElement)("span",{className:"hint"},this.props.object.state.results[this.props.field_name].result.text),(0,t.createElement)("span",{dangerouslySetInnerHTML:{__html:this.props.field.help}})))):this.props.object.state[this.props.field_name]&&this.props.object.state[this.props.field_name].length>0&&(s="easy-setup-for-wordpress-ok",this.props.object.state.results[this.props.field_name].filled=!0)),(0,t.createElement)(r.TextControl,{label:this.props.field.label,className:s,help:e,onChange:e=>g(this.props.object,this.props.field_name,this.props.field,e),placeholder:this.props.field.placeholder,value:this.props.object.state[this.props.field_name]})}}let a=0;function l(e="id"){return a++,`${e}${a}`}function i(e){setTimeout((()=>{e.props.object.setState({button_disabled:!0}),fetch(easy_setup_for_wordpress.process_info_url,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","X-WP-Nonce":easy_setup_for_wordpress.rest_nonce},body:JSON.stringify({config_name:e.props.object.props.config.name})}).then((e=>e.json())).then((function(t){t.step>0&&t.max>0&&(document.getElementById(e.progressbar_id).value=t.step/t.max*100),document.getElementById(e.label_id).innerHTML=t.step_label,1===t.running?i(e):e.props.object.setState({finish_button_disabled:!1})})).catch((e=>y(e)))}),500)}class p extends s.Component{constructor(){super(...arguments),this.progressbar_id=l(),this.label_id=l()}componentDidMount(){setTimeout((()=>{fetch(easy_setup_for_wordpress.process_url,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","X-WP-Nonce":easy_setup_for_wordpress.rest_nonce},body:JSON.stringify({config_name:this.props.object.props.config.name})}).catch((e=>y(e))),i(this)}),500)}render(){return(0,t.createElement)("div",{className:"easy-setup-for-wordpress-progressbar components-base-control__field"},(0,t.createElement)("label",null,this.props.field.label),(0,t.createElement)("progress",{id:this.progressbar_id,max:"100",value:"0"},"Â "),(0,t.createElement)("p",{id:this.label_id}))}}class d extends s.Component{constructor(){super(...arguments)}render(){let e=(0,t.createElement)("span",{dangerouslySetInnerHTML:{__html:this.props.field.help}}),s="";return this.props.object.state.results[this.props.field_name]&&(this.props.object.state.results[this.props.field_name].result.error?(s="easy-setup-for-wordpress-error",this.props.object.state.results[this.props.field_name].result.text&&(e=(0,t.createElement)(t.Fragment,null,(0,t.createElement)("span",{className:"hint"},this.props.object.state.results[this.props.field_name].result.text),(0,t.createElement)("span",{dangerouslySetInnerHTML:{__html:this.props.field.help}})))):this.props.object.state[this.props.field_name]&&this.props.object.state[this.props.field_name].length>0&&(s="easy-setup-for-wordpress-ok")),(0,t.createElement)(r.CheckboxControl,{label:this.props.field.label,className:s,help:e,onChange:e=>g(this.props.object,this.props.field_name,this.props.field,e?1:0),checked:this.props.object.state[this.props.field_name]})}}function c(){return(new Date).getTime()}const h=window.wp.api;var f=e.n(h);const u=window.ReactDOM;class m extends s.Component{constructor(){super(...arguments),this.state={results:{},step:1,button_disabled:!0,finish_button_disabled:!0,is_api_loaded:!1,fields:this.props.fields},Object.keys(this.state.fields).map((e=>{Object.keys(this.state.fields[e]).map((e=>{this.state[e]=""}))}))}componentDidMount(){f().loadPromise.then((()=>{const{is_api_loaded:e}=this.state;!1===e&&(this.settings=new(f().models.Settings),this.settings.fetch().then((e=>{let t={results:{},is_api_loaded:!0};Object.keys(this.state.fields).map((s=>{Object.keys(this.state.fields[s]).map((s=>{void 0!==e[s]&&(t[s]=e[s],t.results[s]={result:[]})}))})),this.setState(t)})))}))}renderControlSetting(e,s){switch(s.type){case"TextControl":return(0,t.createElement)(n,{field_name:e,field:s,object:this});case"CheckboxControl":return(0,t.createElement)(d,{field_name:e,field:s,object:this});case"RadioControl":return(0,t.createElement)(o,{field_name:e,field:s,object:this});case"ProgressBar":return(0,t.createElement)(p,{field_name:e,field:s,object:this});default:return(0,t.createElement)("div",{dangerouslySetInnerHTML:{__html:s.text}})}}render(){return function(e){let t=0,s=0;Object.keys(e.state.fields[e.state.step]).map((r=>{t++,(e.state[r]&&e.state.results[r]&&0===e.state.results[r].result.length||"Text"===e.state.fields[e.state.step][r].type||"ProgressBar"===e.state.fields[e.state.step][r].type&&!e.state.finish_button_disabled||"TextControl"===e.state.fields[e.state.step][r].type&&!e.state.fields[e.state.step][r].required||"TextControl"===e.state.fields[e.state.step][r].type&&e.state.fields[e.state.step][r].required&&e.state.results[r]&&0===e.state.results[r].result.length||"CheckboxControl"===e.state.fields[e.state.step][r].type)&&s++})),e.state.button_disabled=t!==s}(this),(0,t.createElement)(s.Fragment,null,(0,t.createElement)("div",{className:"easy-setup-for-wordpress-header"},(0,t.createElement)("div",{className:"easy-setup-for-wordpress-container"},(0,t.createElement)("div",{className:"easy-setup-for-wordpress-title"},(0,t.createElement)("h1",null,this.props.config.title)))),(0,t.createElement)("div",{className:"easy-setup-for-wordpress-main"},(0,t.createElement)(r.Panel,null,(0,t.createElement)(r.PanelBody,null,Object.keys(this.state.fields[this.state.step]).map((e=>(0,t.createElement)("div",{key:e},this.renderControlSetting(e,this.state.fields[this.state.step][e])))),1===this.state.step&&this.props.config.skip_url&&(0,t.createElement)(r.Button,{isSecondary:!0,onClick:()=>location.href=this.props.config.skip_url},(0,t.createElement)("span",{dangerouslySetInnerHTML:{__html:this.props.config.skip_button_label}})),this.state.step>1&&this.state.step!==Object.keys(this.state.fields).length&&(0,t.createElement)(r.Button,{isSecondary:!0,onClick:()=>this.setState({step:this.state.step-1})},(0,t.createElement)("span",{dangerouslySetInnerHTML:{__html:this.props.config.back_button_label}})),this.state.step<Object.keys(this.state.fields).length&&(0,t.createElement)(r.Button,{isPrimary:!0,disabled:this.state.button_disabled,onClick:()=>_(this)},(0,t.createElement)("span",{dangerouslySetInnerHTML:{__html:this.props.config.continue_button_label}})),this.state.step===Object.keys(this.state.fields).length&&(0,t.createElement)(r.Button,{isPrimary:!0,disabled:this.state.finish_button_disabled,onClick:()=>b(this)},(0,t.createElement)("span",{dangerouslySetInnerHTML:{__html:this.props.config.finish_button_label}}))))))}}document.addEventListener("DOMContentLoaded",(()=>{let e=document.getElementById("easy-setup-for-wordpress");if(e){if(!e.dataset.fields||!e.dataset.config)return;void 0===ReactDOM.createRoot?(0,u.render)((0,t.createElement)(m,{fields:JSON.parse(e.dataset.fields),config:JSON.parse(e.dataset.config)}),e):ReactDOM.createRoot(e).render((0,t.createElement)(m,{fields:JSON.parse(e.dataset.fields),config:JSON.parse(e.dataset.config)}))}}));const _=e=>{let t=e.state;delete t.is_api_loaded,new(f().models.Settings)(t).save(),e.props.config.update_fields?fetch(easy_setup_for_wordpress.get_fields+"/"+e.props.config.name,{method:"GET",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","X-WP-Nonce":easy_setup_for_wordpress.rest_nonce}}).then((e=>e.json())).then((function(t){e.setState({fields:t,date:c()}),e.setState({step:e.state.step+1})})).catch((e=>y(e))):e.setState({step:e.state.step+1})},b=e=>{fetch(easy_setup_for_wordpress.completed_url,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","X-WP-Nonce":easy_setup_for_wordpress.rest_nonce},body:JSON.stringify({config_name:e.props.config.name})}).then((e=>e.json())).then((function(e){e.forward&&(location.href=e.forward)})).catch((e=>y(e)))},g=(e,t,s,r)=>{s.validation_callback?fetch(easy_setup_for_wordpress.validation_url,{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","X-WP-Nonce":easy_setup_for_wordpress.rest_nonce},body:JSON.stringify({config_name:e.props.config.name,step:e.state.step,field_name:t,value:r})}).then((e=>e.json())).then((function(s){e.state.results[t]=s,e.setState({date:c()})})).catch((e=>y(e))):e.state.results[t]={field_name:t,result:r.length>0?"":"error"},e.setState({[t]:r})};function y(e){alert("The following error occurred: "+e)}})();